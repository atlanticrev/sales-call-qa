{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 9, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/_components/visually-hidden-input/styles.module.scss [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"visuallyHidden\": \"styles-module-scss-module__WrIM4a__visuallyHidden\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA"}},
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/max_tarasyuk/Downloads/projects/sales-call-qa/frontend/src/app/_components/visually-hidden-input/index.tsx"],"sourcesContent":["import { forwardRef } from 'react';\n\nimport styles from './styles.module.scss';\n\ntype Props = React.InputHTMLAttributes<HTMLInputElement>;\n\nexport const VisuallyHiddenInput = forwardRef<HTMLInputElement, Props>(\n    (props, ref) => {\n        return (\n            <input\n                ref={ref}\n                type=\"file\"\n                className={styles.visuallyHidden}\n                {...props}\n            />\n        );\n    }\n);\n\nVisuallyHiddenInput.displayName = 'VisuallyHiddenInput';\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAIO,MAAM,oCAAsB,IAAA,mNAAU,EACzC,CAAC,OAAO;IACJ,qBACI,8OAAC;QACG,KAAK;QACL,MAAK;QACL,WAAW,0LAAM,CAAC,cAAc;QAC/B,GAAG,KAAK;;;;;;AAGrB;AAGJ,oBAAoB,WAAW,GAAG"}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/_components/prompt-editor/styles.module.scss [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"editor\": \"styles-module-scss-module__gHRCIW__editor\",\n  \"sendButton\": \"styles-module-scss-module__gHRCIW__sendButton\",\n  \"textarea\": \"styles-module-scss-module__gHRCIW__textarea\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 51, "column": 0}, "map": {"version":3,"sources":["file:///Users/max_tarasyuk/Downloads/projects/sales-call-qa/frontend/src/app/_components/prompt-editor/index.tsx"],"sourcesContent":["'use client';\n\nimport { FormEvent, useRef, useState } from 'react';\nimport {\n  Button,\n  Card,\n  FormControl,\n  FormHelperText,\n  Modal,\n  Stack,\n  TextField,\n  Typography,\n} from '@mui/material';\nimport CloudUploadIcon from '@mui/icons-material/CloudUpload';\n\nimport { VisuallyHiddenInput } from '../visually-hidden-input';\nimport styles from './styles.module.scss';\n\ntype StartResponse = {\n  jobId: string;\n};\n\nasync function startProcess(formData: FormData): Promise<StartResponse> {\n  const res = await fetch('/api/process/start', {\n    method: 'POST',\n    body: formData,\n  });\n\n  if (!res.ok) {\n    throw new Error('Failed to start process');\n  }\n\n  return res.json();\n}\n\n\nconst defaultFileInputText = 'Upload audio file (.mp3, .wav)';\n\ntype ProgressEvent = {\n  stage: string;\n  level?: string;\n  message: string;\n};\n\nexport function PromptEditor() {\n  const formRef = useRef<HTMLFormElement>(null);\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  const [fileInputText, setFileInputText] = useState(defaultFileInputText);\n\n  const [open, setOpen] = useState(false);\n\n  const [statusText, setStatusText] = useState<string>('');\n\n  const [details, setDetails] = useState<string[]>([]);\n\n  const [jobId, setJobId] = useState<string | null>(null);\n\n  const [isDone, setIsDone] = useState(false);\n\n  const handleSubmit = async (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n\n    const formData = new FormData(formRef.current ?? undefined);\n\n    setErrors({});\n    setDetails([]);\n    setIsDone(false);\n\n    if (!formData.get('prompt')) {\n      setErrors({ prompt: 'Prompt cannot be empty' });\n      return;\n    }\n\n    if (!formData.get('file') || !(formData.get('file') instanceof File)) {\n      setErrors({ file: 'File cannot be empty' });\n      return;\n    }\n\n    try {\n      const { jobId } = await startProcess(formData);\n\n      setJobId(jobId);\n      setOpen(true);\n\n      const eventSource = new EventSource(`/api/process/stream?jobId=${jobId}`);\n\n      eventSource.onmessage = (e) => {\n        const event: ProgressEvent = JSON.parse(e.data);\n\n        setStatusText(event.message);\n\n        if (event.level === 'debug') {\n          setDetails((prev) => [...prev, event.message]);\n        }\n\n        if (event.stage === 'done') {\n          setIsDone(true);\n          eventSource.close();\n        }\n\n        if (event.stage === 'error') {\n          eventSource.close();\n        }\n      };\n\n      eventSource.onerror = () => {\n        eventSource.close();\n      };\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  return (\n    <>\n      <Stack\n        ref={formRef}\n        spacing={4}\n        className={styles.editor}\n        component=\"form\"\n        onSubmit={handleSubmit}\n      >\n        <FormControl error={Boolean(errors['file'])}>\n          <Button\n            component=\"label\"\n            variant=\"contained\"\n            startIcon={<CloudUploadIcon />}\n          >\n            {fileInputText}\n\n            <VisuallyHiddenInput\n              name=\"file\"\n              onChange={(event) => {\n                const files = event.target.files;\n                if (files?.length) {\n                  setFileInputText(files[0].name);\n                }\n              }}\n            />\n          </Button>\n\n          {errors['file'] && <FormHelperText>{errors['file']}</FormHelperText>}\n        </FormControl>\n\n        <TextField\n          name=\"prompt\"\n          label=\"Prompt\"\n          multiline\n          minRows={6}\n          fullWidth\n          error={Boolean(errors['prompt'])}\n          helperText={errors['prompt']}\n        />\n\n        <Button type=\"submit\" variant=\"contained\">\n          Send\n        </Button>\n      </Stack>\n\n      <Modal open={open} onClose={() => { }}>\n        <Card\n          sx={{\n            minWidth: 400,\n            position: 'absolute',\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            p: 4,\n          }}\n        >\n          <Typography variant=\"h6\">{statusText || 'Starting…'}</Typography>\n\n          {details.length > 0 && (\n            <Stack spacing={0.5} mt={2}>\n              {details.map((d, i) => (\n                <Typography\n                  key={i}\n                  variant=\"caption\"\n                  color=\"text.secondary\"\n                >\n                  • {d}\n                </Typography>\n              ))}\n            </Stack>\n          )}\n\n          {isDone && jobId && (\n            <Button\n              sx={{ mt: 3 }}\n              variant=\"contained\"\n              href={`/api/process/result?jobId=${jobId}`}\n            >\n              Download PDF\n            </Button>\n          )}\n        </Card>\n      </Modal>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}